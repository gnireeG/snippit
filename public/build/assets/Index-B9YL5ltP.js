import{x as U,y as g,r as k,p as W,o as n,d as c,a as e,c as $,w as r,f as x,u as i,m as C,e as v,F as S,g as V,n as A,t as N,b as w,j as D,q as j,z as B,O as q,A as I,k as z,B as E}from"./app-CkGmGYzl.js";import{A as H}from"./AppLayout-aqw6VBi-.js";import{a as M}from"./DropdownLink-CW2XwFOL.js";import{_ as O}from"./DialogModal-BNwZxAp-.js";import{_ as R}from"./SnippitCard-BfIKdQT4.js";import{_ as T}from"./InputComponent-DxbEoAj5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-CIw4D1Rg.js";const y=U.create();y.interceptors.response.use(p=>p,p=>{var d,l;const s=((l=(d=p.response)==null?void 0:d.data)==null?void 0:l.message)||"An error occurred";return g.commit("addAlert",{type:"error",message:s}),Promise.reject(p)});const G={class:"flex flex-col"},J=e("i",{class:"bi bi-house-door-fill"},null,-1),K={class:"pl-1 mt-0.5"},Q=["onClick"],X=e("i",{class:"bi bi-caret-right-fill"},null,-1),Y=[X],Z=["title","onClick"],ee=e("button",{title:"Options",class:"px-1"},[e("i",{class:"bi bi-three-dots"})],-1),te={class:"rounded-lg p-2 flex"},se=e("button",{class:"btn btn-transparent w-full",title:"Rename folder"},[e("i",{class:"bi bi-input-cursor-text text-lg"})],-1),oe=["onClick"],le=e("i",{class:"bi bi-trash2 text-lg"},null,-1),ne=[le],ae={key:0,class:"pl-1"},re={key:1,class:"pl-3"},ie=["onSubmit"],de=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),ue=["onUpdate:modelValue"],ce=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),pe=e("h3",{class:"heading-3"},"Delete folder",-1),fe=e("p",null,"All contents, including subfolders and Snippits will be deleted permanently.",-1),he={__name:"FolderSelector",props:{folders:{type:Object,required:!0},root:{type:Boolean,default:!1}},setup(p){const s=k(!1),d=k(null),l=k("");function f(t){d.value=t,s.value=!0}function h(){s.value=!1}function m(){d.value&&y.delete(route("app.folders.delete",{folder_id:d.value.id})).then(t=>{t.status==200&&(s.value=!1,g.commit("deleteFolder",t.data.deleted_folder),g.commit("addAlert",{type:"success",message:t.data.message}),g.state.currentFolder.id==t.data.deleted_folder.id&&q.visit(route("app.folders.index")))})}function u(t,a){if(t)_(t,a);else{let b=g.state.path.id;_(b,a)}}function _(t,a){y.post(route("app.folders.create"),{parent_id:t,name:a}).then(b=>{g.commit("addNewFolder",{folder:b.data,parentID:t})})}function L(t){!t.subfolders&&!t.loading?(t.loading=!0,y.get(route("app.folders.loadSubfoldersById",{folderId:t.id})).then(a=>{g.commit("addLoadedSubfolders",{subfolders:a.data,parentID:t.id})})):t.showSubfolders=!t.showSubfolders}function P(t){y.get(route("app.folders.loadFolderWithContent",{folderId:t.id})).then(a=>{let b="/folder/";a.data.path.forEach((o,F)=>{F<a.data.path.length-1?b+=o.slug+"/":b+=o.slug}),window.history.pushState({},"",b),g.commit("updateCurrentFolder",a.data.folder)})}return(t,a)=>{const b=W("FolderSelector",!0);return n(),c(S,null,[e("div",{class:A([p.root?"py-2":""])},[e("div",G,[p.root?(n(),$(i(C),{key:0,href:t.route("app.folders.index"),class:"inline"},{default:r(()=>[J,x(" Home")]),_:1},8,["href"])):v("",!0),(n(!0),c(S,null,V(p.folders,o=>(n(),c("div",K,[e("div",{class:A(["flex items-center gap-2 text-sm whitespace-nowrap px-1 py-0.5 rounded-md group",[i(g).state.currentFolder.id==o.id?"bg-secondary":"bg-primary hover"]])},[e("button",{title:"Load subfolders",onClick:F=>L(o),class:A(["transform transition-transform py-0.5",[o.showSubfolders?"rotate-90":""]])},Y,10,Q),e("button",{title:o.name,onClick:F=>P(o),class:"w-full text-left truncate"},N(o.name),9,Z),w(M,{align:"right",width:"28",class:"opacity-0 group-hover:opacity-100"},{trigger:r(()=>[ee]),content:r(()=>[e("div",te,[se,e("button",{class:"btn btn-transparent w-full",title:"Delete folder",onClick:F=>f(o)},ne,8,oe)])]),_:2},1024)],2),o.subfolders&&o.subfolders.length>0&&o.showSubfolders?(n(),c("div",ae,[w(b,{folders:o.subfolders},null,8,["folders"])])):v("",!0),o.showSubfolders?(n(),c("div",re,[e("form",{onSubmit:D(()=>{u(o.id,o.newSubfolderName),o.newSubfolderName=""},["prevent"]),class:"flex gap-1"},[de,j(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":F=>o.newSubfolderName=F},null,8,ue),[[B,o.newSubfolderName]])],40,ie)])):v("",!0)]))),256)),p.root?(n(),c("form",{key:1,onSubmit:a[1]||(a[1]=D(()=>{u(!1,l.value),l.value=""},["prevent"])),class:"flex gap-1 pl-2"},[ce,j(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":a[0]||(a[0]=o=>l.value=o)},null,512),[[B,l.value]])],32)):v("",!0)])],2),w(O,{show:s.value,onClose:h,maxWidth:"xl"},{title:r(()=>[pe]),content:r(()=>[e("p",null,[x("Are you sure you want to delete the folder "),e("b",null,N(d.value.name),1),x("?")]),fe]),footer:r(()=>[e("button",{class:"btn",onClick:h},"Cancel"),e("button",{class:"btn btn-danger",onClick:m},"Delete")]),_:1},8,["show"])],64)}}},me={key:0,class:"flex gap-2"},_e=e("i",{class:"bi bi-chevron-right"},null,-1),be={key:0,class:"bi bi-chevron-right"},ge={__name:"FolderBreadcrumbs",setup(p){const s=I(),d=z(()=>{let l=s.getters.simplePath;return l.shift(),l=l.map((f,h)=>{const m="/folder/"+l.slice(0,h+1).map(u=>u.slug).join("/");return{...f,pathSlug:m}}),l});return(l,f)=>i(s).state.path?(n(),c("div",me,[w(i(C),{href:l.route("app.folders.index")},{default:r(()=>[x("Home")]),_:1},8,["href"]),_e,(n(!0),c(S,null,V(d.value,(h,m)=>(n(),c(S,null,[w(i(C),{href:h.pathSlug},{default:r(()=>[x(N(h.name),1)]),_:2},1032,["href"]),m!==d.value.length-1?(n(),c("i",be)):v("",!0)],64))),256))])):v("",!0)}},ve={class:"flex gap-4 relative flex-col md:flex-row"},we={class:"min-w-64 flex-grow"},xe={class:"top-0 sticky max-h-48 md:max-h-none overflow-y-auto"},Fe={class:"w-full mt-8"},ye={class:"flex justify-between"},$e={class:"text-sm mb-2"},ke={key:0,class:"heading-1"},Se={key:1,class:"heading-1"},Ce=e("button",{class:"btn"},[x("New "),e("i",{class:"bi bi-plus-lg"})],-1),Ne={class:"rounded-lg p-2"},Ae=e("i",{class:"bi bi-code-slash"},null,-1),De=e("i",{class:"bi bi-folder"},null,-1),Ve={class:"autogrid gap-4 w-full mt-4"},je=e("h3",{class:"heading-3"},"New Folder",-1),Be=["disabled"],ze={__name:"Index",props:{folder:Object,path:Object,simplePath:Object},setup(p){const s=I(),d=p;E(()=>{s.commit("initFolderData",{currentFolder:d.folder,path:d.path})});const l=k(!1),f=k("");function h(){f.value.length<3||(y.post(route("app.folders.create"),{parent_id:s.state.currentFolder.id,name:f.value}).then(m=>{s.commit("addNewFolder",{folder:m.data,parentID:s.state.currentFolder.id})}),l.value=!1,f.value="")}return(m,u)=>(n(),$(H,{title:"Folders"},{default:r(()=>[e("div",null,[e("div",ve,[e("div",we,[e("div",xe,[i(s).state.path?(n(),$(he,{key:0,root:!0,folders:i(s).state.path.subfolders},null,8,["folders"])):v("",!0)])]),e("div",Fe,[e("div",ye,[e("div",null,[e("p",$e,[w(ge)]),i(s).state.currentFolder?(n(),c("h1",ke,N(i(s).state.currentFolder.name),1)):(n(),c("h1",Se,"Root"))]),w(M,{align:"right",width:"48"},{trigger:r(()=>[Ce]),content:r(()=>[e("div",Ne,[i(s).state.currentFolder?(n(),$(i(C),{key:0,href:m.route("app.snippit.showCreate")+"?folder_id="+i(s).state.currentFolder.id,class:"btn btn-transparent w-full block text-center"},{default:r(()=>[Ae,x(" Snippit")]),_:1},8,["href"])):v("",!0),e("button",{class:"btn btn-transparent w-full",onClick:u[0]||(u[0]=_=>l.value=!0)},[De,x(" Folder")])])]),_:1})]),e("div",Ve,[i(s).state.currentFolder?(n(!0),c(S,{key:0},V(i(s).state.currentFolder.snippits,_=>(n(),$(R,{snippit:_},null,8,["snippit"]))),256)):v("",!0)])])])]),w(O,{show:l.value,onClose:u[3]||(u[3]=_=>l.value=!1),maxWidth:"xl"},{title:r(()=>[je]),content:r(()=>[e("div",null,[e("form",{onSubmit:D(h,["prevent"])},[w(T,{modelValue:f.value,"onUpdate:modelValue":u[1]||(u[1]=_=>f.value=_),label:"Folder Name"},null,8,["modelValue"])],32)])]),footer:r(()=>[e("button",{onClick:u[2]||(u[2]=_=>l.value=!1),class:"textlink"},"Cancel"),e("button",{class:"btn",disabled:f.value.length<3,onClick:h},"Save",8,Be)]),_:1},8,["show"])]),_:1}))}};export{ze as default};
