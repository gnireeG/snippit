import{r as k,p as q,o as n,d as p,a as e,c as $,w as d,f as y,j as C,u as a,x as b,m as N,e as g,F as D,g as I,n as A,t as V,b as v,q as O,y as M,O as E,z as L,k as H,A as R}from"./app-BjsabL0h.js";import{A as G}from"./AppLayout-CMgTLfeB.js";import{a as P}from"./DropdownLink-o4B1UbBB.js";import{_ as T}from"./DialogModal-BoOf1QNk.js";import{h as S,_ as J}from"./SnippitCard-BRTOpEii.js";import{I as U}from"./InputComponent-DgHCGIo_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-DI64ukRw.js";import"./CodeMirror-28AMmJu5.js";const K={class:"flex flex-col"},Q=e("i",{class:"bi bi-house-door-fill"},null,-1),X=["onDrop"],Y=["onClick"],Z=e("i",{class:"bi bi-caret-right-fill"},null,-1),ee=[Z],te=["title","onClick"],oe=e("button",{title:"Options",class:"px-1"},[e("i",{class:"bi bi-three-dots"})],-1),se={class:"rounded-lg p-2 flex"},le=e("button",{class:"btn btn-transparent w-full",title:"Rename folder"},[e("i",{class:"bi bi-input-cursor-text text-lg"})],-1),ne=["onClick"],ae=e("i",{class:"bi bi-trash2 text-lg"},null,-1),re=[ae],ie={key:0,class:"pl-1"},de={key:1,class:"pl-3"},ue=["onSubmit"],ce=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),pe=["onUpdate:modelValue"],fe=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),me=e("h3",{class:"heading-3"},"Delete folder",-1),he=e("p",null,"All contents, including subfolders and Snippits will be deleted permanently.",-1),be={__name:"FolderSelector",props:{folders:{type:Object,required:!0},root:{type:Boolean,default:!1}},emits:["navigate"],setup(F,{emit:l}){const _=l,r=k(!1),c=k(null),i=k("");function x(o){c.value=o,r.value=!0}function w(){r.value=!1}function u(){c.value&&S.delete(route("app.folders.delete",{folder_id:c.value.id})).then(o=>{o.status==200&&(r.value=!1,b.commit("deleteFolder",o.data.deleted_folder),b.commit("addAlert",{type:"success",message:o.data.message}),b.state.currentFolder.id==o.data.deleted_folder.id&&E.visit(route("app.folders.index")))})}function f(o,s){if(o)j(o,s);else{let h=b.state.path.id;j(h,s)}}function j(o,s){S.post(route("app.folders.create"),{parent_id:o,name:s}).then(h=>{b.commit("addNewFolder",{folder:h.data,parentID:o})})}function z(o){!o.subfolders&&!o.loading?(o.loading=!0,S.get(route("app.folders.loadSubfoldersById",{folderId:o.id})).then(s=>{b.commit("addLoadedSubfolders",{subfolders:s.data,parentID:o.id})})):o.showSubfolders=!o.showSubfolders}function W(o){S.get(route("app.folders.loadFolderWithContent",{folderId:o.id})).then(s=>{let h="/app/folder/";s.data.path.forEach((t,m)=>{m<s.data.path.length-1?h+=t.slug+"/":h+=t.slug}),window.history.pushState({},"",h),b.commit("updateCurrentFolder",s.data.folder),_("navigate")})}function B(o,s){o.stopPropagation();const h=o.dataTransfer.getData("event"),t=o.dataTransfer.getData("snippitId");console.log(h,t,s),S.post(route("app.snippit.move"),{snippit_id:t,folder_id:s}).then(m=>{m.status==200&&(b.commit("addAlert",{type:"success",message:m.data.message}),b.commit("removeSnippit",{snippitId:t,folderId:s}))})}return(o,s)=>{const h=q("FolderSelector",!0);return n(),p(D,null,[e("div",{class:A([F.root?"py-2":""])},[e("div",K,[F.root?(n(),$(a(N),{key:0,onDragover:s[0]||(s[0]=C(()=>{},["prevent"])),onDrop:s[1]||(s[1]=t=>B(t,a(b).state.path.id)),href:o.route("app.folders.index"),class:"inline"},{default:d(()=>[Q,y(" Home")]),_:1},8,["href"])):g("",!0),(n(!0),p(D,null,I(F.folders,t=>(n(),p("div",{class:"pl-1 mt-0.5",onDragover:s[3]||(s[3]=C(()=>{},["prevent"])),onDrop:m=>B(m,t.id)},[e("div",{class:A(["flex items-center gap-2 text-sm whitespace-nowrap px-1 py-0.5 rounded-md group",[a(b).state.currentFolder.id==t.id?"bg-secondary":"bg-primary hover"]])},[e("button",{title:"Load subfolders",onClick:m=>z(t),class:A(["transform transition-transform py-0.5",[t.showSubfolders?"rotate-90":""]])},ee,10,Y),e("button",{title:t.name,onClick:m=>W(t),class:"w-full text-left truncate"},V(t.name),9,te),v(P,{align:"right",width:"28",class:"md:opacity-0 md:group-hover:opacity-100"},{trigger:d(()=>[oe]),content:d(()=>[e("div",se,[le,e("button",{class:"btn btn-transparent w-full",title:"Delete folder",onClick:m=>x(t)},re,8,ne)])]),_:2},1024)],2),t.subfolders&&t.subfolders.length>0&&t.showSubfolders?(n(),p("div",ie,[v(h,{folders:t.subfolders,onNavigate:s[2]||(s[2]=m=>_("navigate"))},null,8,["folders"])])):g("",!0),t.showSubfolders?(n(),p("div",de,[e("form",{onSubmit:C(()=>{f(t.id,t.newSubfolderName),t.newSubfolderName=""},["prevent"]),class:"flex gap-1"},[ce,O(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":m=>t.newSubfolderName=m},null,8,pe),[[M,t.newSubfolderName]])],40,ue)])):g("",!0)],40,X))),256)),F.root?(n(),p("form",{key:1,onSubmit:s[5]||(s[5]=C(()=>{f(!1,i.value),i.value=""},["prevent"])),class:"flex gap-1 pl-2"},[fe,O(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":s[4]||(s[4]=t=>i.value=t)},null,512),[[M,i.value]])],32)):g("",!0)])],2),v(T,{show:r.value,onClose:w,maxWidth:"xl"},{title:d(()=>[me]),content:d(()=>[e("p",null,[y("Are you sure you want to delete the folder "),e("b",null,V(c.value.name),1),y("?")]),he]),footer:d(()=>[e("button",{class:"btn",onClick:w},"Cancel"),e("button",{class:"btn btn-danger",onClick:u},"Delete")]),_:1},8,["show"])],64)}}},_e={key:0,class:"flex gap-2"},ve=e("i",{class:"bi bi-chevron-right"},null,-1),ge={key:0,class:"bi bi-chevron-right"},we={__name:"FolderBreadcrumbs",setup(F){const l=L(),_=H(()=>{let r=l.getters.simplePath;return r?(r.shift(),r=r.map((c,i)=>{const x="/folder/"+r.slice(0,i+1).map(w=>w.slug).join("/");return{...c,pathSlug:x}}),r):[]});return(r,c)=>a(l).state.path?(n(),p("div",_e,[v(a(N),{href:r.route("app.folders.index")},{default:d(()=>[y("Home")]),_:1},8,["href"]),ve,(n(!0),p(D,null,I(_.value,(i,x)=>(n(),p(D,null,[v(a(N),{href:i.pathSlug},{default:d(()=>[y(V(i.name),1)]),_:2},1032,["href"]),x!==_.value.length-1?(n(),p("i",ge)):g("",!0)],64))),256))])):g("",!0)}},xe={class:"flex gap-4 relative flex-col md:flex-row"},ye={class:"min-w-64 flex-grow relative"},Fe={class:"top-0 sticky max-h-48 md:max-h-none overflow-y-auto md:overflow-y-visible pb-10 md:pb-0"},$e={class:"w-full mt-8"},Se={class:"flex justify-between items-center"},ke={class:"text-sm mb-2"},Ce={key:0,class:"heading-1"},Ne={key:1,class:"heading-1"},De=e("button",{class:"btn"},[y("New "),e("i",{class:"bi bi-plus-lg"})],-1),Ve={class:"rounded-lg p-2"},Ae=e("i",{class:"bi bi-code-slash"},null,-1),Ie=e("i",{class:"bi bi-folder"},null,-1),je={class:"flex justify-end"},Be={class:"autogrid gap-4 w-full mt-4"},Oe=e("i",{class:"bi bi-plus-circle-dotted text-2xl"},null,-1),Me=e("p",null,"Create new Snippit",-1),Ue=e("h3",{class:"heading-3"},"New Folder",-1),Le=["disabled"],Je={__name:"Index",props:{folder:Object,path:Object,simplePath:Object},setup(F){const l=L(),_=k(""),r=F;R(()=>{l.commit("initFolderData",{currentFolder:r.folder,path:r.path})});const c=k(!1),i=k("");function x(){i.value.length<3||(S.post(route("app.folders.create"),{parent_id:l.state.currentFolder.id,name:i.value}).then(w=>{l.commit("addNewFolder",{folder:w.data,parentID:l.state.currentFolder.id})}),c.value=!1,i.value="")}return(w,u)=>(n(),$(G,{title:"Folders"},{default:d(()=>[e("div",null,[e("div",xe,[e("div",ye,[e("div",Fe,[a(l).state.path?(n(),$(be,{key:0,root:!0,folders:a(l).state.path.subfolders,onNavigate:u[0]||(u[0]=f=>_.value="")},null,8,["folders"])):g("",!0)])]),e("div",$e,[e("div",Se,[e("div",null,[e("p",ke,[v(we)]),a(l).state.currentFolder?(n(),p("h1",Ce,V(a(l).state.currentFolder.name),1)):(n(),p("h1",Ne,"Root"))]),v(P,{align:"right",width:"48"},{trigger:d(()=>[De]),content:d(()=>[e("div",Ve,[a(l).state.currentFolder?(n(),$(a(N),{key:0,href:w.route("app.snippit.showCreate")+"?folder_id="+a(l).state.currentFolder.id,class:"btn btn-transparent w-full block text-center"},{default:d(()=>[Ae,y(" Snippit")]),_:1},8,["href"])):g("",!0),e("button",{class:"btn btn-transparent w-full",onClick:u[1]||(u[1]=f=>c.value=!0)},[Ie,y(" Folder")])])]),_:1})]),e("div",je,[v(U,{modelValue:_.value,"onUpdate:modelValue":u[2]||(u[2]=f=>_.value=f),placeholder:"Search",type:"search",bgClass:"bg-primary",size:"sm"},null,8,["modelValue"])]),e("div",Be,[a(l).state.currentFolder?(n(!0),p(D,{key:0},I(a(l).state.currentFolder.snippits,f=>(n(),$(J,{snippit:f,draggable:!0,deleteAble:!0,searchValue:_.value},null,8,["snippit","searchValue"]))),256)):g("",!0),a(l).state.currentFolder?(n(),$(a(N),{key:1,title:"New Snippit",href:w.route("app.snippit.showCreate")+"?folder_id="+a(l).state.currentFolder.id,class:"border-2 border-dashed border-gray-400 flex justify-center items-center flex-col p-4"},{default:d(()=>[Oe,Me]),_:1},8,["href"])):g("",!0)])])])]),v(T,{show:c.value,onClose:u[5]||(u[5]=f=>c.value=!1),maxWidth:"xl"},{title:d(()=>[Ue]),content:d(()=>[e("div",null,[e("form",{onSubmit:C(x,["prevent"])},[v(U,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=f=>i.value=f),label:"Folder Name"},null,8,["modelValue"])],32)])]),footer:d(()=>[e("button",{onClick:u[4]||(u[4]=f=>c.value=!1),class:"textlink"},"Cancel"),e("button",{class:"btn",disabled:i.value.length<3,onClick:x},"Save",8,Le)]),_:1},8,["show"])]),_:1}))}};export{Je as default};
