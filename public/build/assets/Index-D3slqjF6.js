import{x as T,y as _,r as F,p as W,o as a,d as u,a as e,c as S,w as c,f as x,u as m,m as V,e as w,F as k,g as D,n as N,t as C,b,j as A,q as I,z as j,O as q,A as B,B as M,k as z}from"./app-B9mYPfgG.js";import{A as E}from"./AppLayout-8kXNQ4pq.js";import{a as O}from"./DropdownLink-Bydu3QB-.js";import{_ as L}from"./DialogModal-BiCBRlrg.js";import{_ as H}from"./SnippitCard-D4ld8JTX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-BxQhJCvO.js";const y=T.create();y.interceptors.response.use(r=>r,r=>{var n,o;const s=((o=(n=r.response)==null?void 0:n.data)==null?void 0:o.message)||"An error occurred";return _.commit("addAlert",{type:"error",message:s}),Promise.reject(r)});const R={class:"flex flex-col"},G=e("i",{class:"bi bi-house-door-fill"},null,-1),J={class:"pl-1 mt-0.5"},K=["onClick"],Q=e("i",{class:"bi bi-caret-right-fill"},null,-1),X=[Q],Y=["title","onClick"],Z=e("button",{title:"Options"},[e("i",{class:"bi bi-three-dots"})],-1),ee={class:"rounded-lg p-2 flex"},te=e("button",{class:"btn btn-transparent w-full",title:"Rename folder"},[e("i",{class:"bi bi-input-cursor-text text-lg"})],-1),oe=["onClick"],se=e("i",{class:"bi bi-trash2 text-lg"},null,-1),le=[se],ne={key:0,class:"pl-1"},ae={key:1,class:"pl-3"},re=["onSubmit"],de=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),ie=["onUpdate:modelValue"],ue=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),ce=e("h3",{class:"heading-3"},"Delete folder",-1),pe=e("p",null,"All contents, including subfolders and Snippits will be deleted permanently.",-1),fe={__name:"FolderSelector",props:{folders:{type:Object,required:!0},root:{type:Boolean,default:!1}},setup(r){const s=F(!1),n=F(null),o=F("");function d(t){n.value=t,s.value=!0}function f(){s.value=!1}function g(){n.value&&y.delete(route("app.folders.delete",{folder_id:n.value.id})).then(t=>{t.status==200&&(s.value=!1,_.commit("deleteFolder",t.data.deleted_folder),_.commit("addAlert",{type:"success",message:t.data.message}),_.state.currentFolder.id==t.data.deleted_folder.id&&q.visit(route("app.folders.index")))})}function p(t,i){if(t)h(t,i);else{let v=_.state.path.id;h(v,i)}}function h(t,i){y.post(route("app.folders.create"),{parent_id:t,name:i}).then(v=>{_.commit("addNewFolder",{folder:v.data,parentID:t})})}function P(t){!t.subfolders&&!t.loading?(t.loading=!0,y.get(route("app.folders.loadSubfoldersById",{folderId:t.id})).then(i=>{_.commit("addLoadedSubfolders",{subfolders:i.data,parentID:t.id})})):t.showSubfolders=!t.showSubfolders}function U(t){y.get(route("app.folders.loadFolderWithContent",{folderId:t.id})).then(i=>{let v="/folder/";i.data.path.forEach(l=>{v+=l.slug+"/"}),window.history.pushState({},"",v),_.commit("updateCurrentFolder",i.data.folder)})}return(t,i)=>{const v=W("FolderSelector",!0);return a(),u(k,null,[e("div",{class:N([r.root?"py-2":""])},[e("div",R,[r.root?(a(),S(m(V),{key:0,href:t.route("app.folders.index"),class:"inline"},{default:c(()=>[G,x(" Home")]),_:1},8,["href"])):w("",!0),(a(!0),u(k,null,D(r.folders,l=>(a(),u("div",J,[e("div",{class:N(["flex items-center gap-2 text-sm whitespace-nowrap px-1 py-0.5 rounded-md group",[m(_).state.currentFolder.id==l.id?"bg-secondary":"bg-primary hover"]])},[e("button",{title:"Load subfolders",onClick:$=>P(l),class:N(["transform transition-transform py-0.5",[l.showSubfolders?"rotate-90":""]])},X,10,K),e("button",{title:l.name,onClick:$=>U(l),class:"w-full text-left truncate"},C(l.name),9,Y),b(O,{align:"right",width:"28",class:"opacity-0 group-hover:opacity-100"},{trigger:c(()=>[Z]),content:c(()=>[e("div",ee,[te,e("button",{class:"btn btn-transparent w-full",title:"Delete folder",onClick:$=>d(l)},le,8,oe)])]),_:2},1024)],2),l.subfolders&&l.subfolders.length>0&&l.showSubfolders?(a(),u("div",ne,[b(v,{folders:l.subfolders},null,8,["folders"])])):w("",!0),l.showSubfolders?(a(),u("div",ae,[e("form",{onSubmit:A(()=>{p(l.id,l.newSubfolderName),l.newSubfolderName=""},["prevent"]),class:"flex gap-1"},[de,I(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":$=>l.newSubfolderName=$},null,8,ie),[[j,l.newSubfolderName]])],40,re)])):w("",!0)]))),256)),r.root?(a(),u("form",{key:1,onSubmit:i[1]||(i[1]=A(()=>{p(!1,o.value),o.value=""},["prevent"])),class:"flex gap-1 pl-2"},[ue,I(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":i[0]||(i[0]=l=>o.value=l)},null,512),[[j,o.value]])],32)):w("",!0)])],2),b(L,{show:s.value,onClose:f,maxWidth:"xl"},{title:c(()=>[ce]),content:c(()=>[e("p",null,[x("Are you sure you want to delete the folder "),e("b",null,C(n.value.name),1),x("?")]),pe]),footer:c(()=>[e("button",{class:"btn",onClick:f},"Cancel"),e("button",{class:"btn btn-danger",onClick:g},"Delete")]),_:1},8,["show"])],64)}}},me=["value"],he={__name:"InputText",props:{modelValue:String},emits:["update:modelValue"],setup(r,{expose:s}){const n=F(null);return B(()=>{n.value.hasAttribute("autofocus")&&n.value.focus()}),s({focus:()=>n.value.focus()}),(o,d)=>(a(),u("input",{ref_key:"input",ref:n,class:"border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:r.modelValue,onInput:d[0]||(d[0]=f=>o.$emit("update:modelValue",f.target.value))},null,40,me))}},_e={key:0,class:"flex gap-2"},be=e("i",{class:"bi bi-chevron-right"},null,-1),ge={key:0,class:"bi bi-chevron-right"},ve={__name:"FolderBreadcrumbs",setup(r){const s=M(),n=z(()=>{let o=s.getters.simplePath;return o.shift(),o=o.map((d,f)=>{const g="/folder/"+o.slice(0,f+1).map(p=>p.slug).join("/");return{...d,pathSlug:g}}),o});return(o,d)=>m(s).state.path?(a(),u("div",_e,[b(m(V),{href:o.route("app.folders.index")},{default:c(()=>[x("Home")]),_:1},8,["href"]),be,(a(!0),u(k,null,D(n.value,(f,g)=>(a(),u(k,null,[b(m(V),{href:f.pathSlug},{default:c(()=>[x(C(f.name),1)]),_:2},1032,["href"]),g!==n.value.length-1?(a(),u("i",ge)):w("",!0)],64))),256))])):w("",!0)}},we={class:"p-8"},xe={class:"flex gap-4 relative mt-8"},ye={class:"min-w-64 flex-grow"},Fe={class:"top-0 sticky"},ke={class:"w-full"},$e={class:"flex justify-between"},Se={class:"text-sm mb-2"},Ce={key:0,class:"heading-1"},Ne={key:1,class:"heading-1"},Ve=e("button",{class:"btn"},[x("New "),e("i",{class:"bi bi-plus-lg"})],-1),Ae={class:"rounded-lg p-2"},De=e("button",{class:"btn btn-transparent w-full"},[e("i",{class:"bi bi-code-slash"}),x(" Snippit")],-1),Ie=e("i",{class:"bi bi-folder"},null,-1),je={class:"autogrid gap-4 w-full mt-4"},Be=e("h3",{class:"heading-3"},"New Folder",-1),Me=["disabled"],ze={__name:"Index",props:{folder:Object,path:Object,simplePath:Object},setup(r){const s=M(),n=r;B(()=>{s.commit("initFolderData",{currentFolder:n.folder,path:n.path})});const o=F(!1),d=F("");function f(){d.value.length<3||(y.post(route("app.folders.create"),{parent_id:s.state.currentFolder.id,name:d.value}).then(g=>{s.commit("addNewFolder",{folder:g.data,parentID:s.state.currentFolder.id})}),o.value=!1,d.value="")}return(g,p)=>(a(),S(E,{title:"Folders"},{default:c(()=>[e("div",we,[e("div",xe,[e("div",ye,[e("div",Fe,[m(s).state.path?(a(),S(fe,{key:0,root:!0,folders:m(s).state.path.subfolders},null,8,["folders"])):w("",!0)])]),e("div",ke,[e("div",$e,[e("div",null,[e("p",Se,[b(ve)]),m(s).state.currentFolder?(a(),u("h1",Ce,C(m(s).state.currentFolder.name),1)):(a(),u("h1",Ne,"Root"))]),b(O,{align:"right",width:"48"},{trigger:c(()=>[Ve]),content:c(()=>[e("div",Ae,[De,e("button",{class:"btn btn-transparent w-full",onClick:p[0]||(p[0]=h=>o.value=!0)},[Ie,x(" Folder")])])]),_:1})]),e("div",je,[m(s).state.currentFolder?(a(!0),u(k,{key:0},D(m(s).state.currentFolder.snippits,h=>(a(),S(H,{snippit:h},null,8,["snippit"]))),256)):w("",!0)])])])]),b(L,{show:o.value,onClose:p[3]||(p[3]=h=>o.value=!1),maxWidth:"xl"},{title:c(()=>[Be]),content:c(()=>[e("div",null,[e("form",{onSubmit:A(f,["prevent"])},[b(he,{modelValue:d.value,"onUpdate:modelValue":p[1]||(p[1]=h=>d.value=h),label:"Folder Name"},null,8,["modelValue"])],32)])]),footer:c(()=>[e("button",{onClick:p[2]||(p[2]=h=>o.value=!1),class:"textlink"},"Cancel"),e("button",{class:"btn",disabled:d.value.length<3,onClick:f},"Save",8,Me)]),_:1},8,["show"])]),_:1}))}};export{ze as default};
