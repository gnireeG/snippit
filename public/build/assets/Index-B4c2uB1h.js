import{r as k,p as U,o as a,d as u,a as e,c as F,w as i,f as x,j as S,u as r,x as m,m as C,e as v,F as D,g as V,n as A,t as N,b as w,q as j,y as B,O as W,z as O,k as q,A as z}from"./app-BIYzwX-g.js";import{A as E}from"./AppLayout-DYg7kmZO.js";import{a as M}from"./DropdownLink-CGGjj1-r.js";import{_ as L}from"./DialogModal-Btf5kZxw.js";import{h as $,_ as H}from"./SnippitCard-DS1lROVh.js";import{_ as R}from"./InputComponent-BmfPxMl2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-CXVkH-mn.js";import"./CodeMirror-B19A6hs5.js";const G={class:"flex flex-col"},J=e("i",{class:"bi bi-house-door-fill"},null,-1),K=["onDrop"],Q=["onClick"],X=e("i",{class:"bi bi-caret-right-fill"},null,-1),Y=[X],Z=["title","onClick"],ee=e("button",{title:"Options",class:"px-1"},[e("i",{class:"bi bi-three-dots"})],-1),te={class:"rounded-lg p-2 flex"},oe=e("button",{class:"btn btn-transparent w-full",title:"Rename folder"},[e("i",{class:"bi bi-input-cursor-text text-lg"})],-1),se=["onClick"],le=e("i",{class:"bi bi-trash2 text-lg"},null,-1),ne=[le],ae={key:0,class:"pl-1"},re={key:1,class:"pl-3"},ie=["onSubmit"],de=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),ue=["onUpdate:modelValue"],ce=e("button",{type:"submit",title:"Add folder"},[e("i",{class:"bi bi-folder-plus"})],-1),pe=e("h3",{class:"heading-3"},"Delete folder",-1),fe=e("p",null,"All contents, including subfolders and Snippits will be deleted permanently.",-1),me={__name:"FolderSelector",props:{folders:{type:Object,required:!0},root:{type:Boolean,default:!1}},setup(y){const l=k(!1),h=k(null),n=k("");function c(o){h.value=o,l.value=!0}function b(){l.value=!1}function _(){h.value&&$.delete(route("app.folders.delete",{folder_id:h.value.id})).then(o=>{o.status==200&&(l.value=!1,m.commit("deleteFolder",o.data.deleted_folder),m.commit("addAlert",{type:"success",message:o.data.message}),m.state.currentFolder.id==o.data.deleted_folder.id&&W.visit(route("app.folders.index")))})}function d(o,s){if(o)g(o,s);else{let p=m.state.path.id;g(p,s)}}function g(o,s){$.post(route("app.folders.create"),{parent_id:o,name:s}).then(p=>{m.commit("addNewFolder",{folder:p.data,parentID:o})})}function P(o){!o.subfolders&&!o.loading?(o.loading=!0,$.get(route("app.folders.loadSubfoldersById",{folderId:o.id})).then(s=>{m.commit("addLoadedSubfolders",{subfolders:s.data,parentID:o.id})})):o.showSubfolders=!o.showSubfolders}function T(o){$.get(route("app.folders.loadFolderWithContent",{folderId:o.id})).then(s=>{let p="/folder/";s.data.path.forEach((t,f)=>{f<s.data.path.length-1?p+=t.slug+"/":p+=t.slug}),window.history.pushState({},"",p),m.commit("updateCurrentFolder",s.data.folder)})}function I(o,s){o.stopPropagation();const p=o.dataTransfer.getData("event"),t=o.dataTransfer.getData("snippitId");console.log(p,t,s),$.post(route("app.snippit.move"),{snippit_id:t,folder_id:s}).then(f=>{f.status==200&&(m.commit("addAlert",{type:"success",message:f.data.message}),m.commit("removeSnippit",{snippitId:t,folderId:s}))})}return(o,s)=>{const p=U("FolderSelector",!0);return a(),u(D,null,[e("div",{class:A([y.root?"py-2":""])},[e("div",G,[y.root?(a(),F(r(C),{key:0,onDragover:s[0]||(s[0]=S(()=>{},["prevent"])),onDrop:s[1]||(s[1]=t=>I(t,r(m).state.path.id)),href:o.route("app.folders.index"),class:"inline"},{default:i(()=>[J,x(" Home")]),_:1},8,["href"])):v("",!0),(a(!0),u(D,null,V(y.folders,t=>(a(),u("div",{class:"pl-1 mt-0.5",onDragover:s[2]||(s[2]=S(()=>{},["prevent"])),onDrop:f=>I(f,t.id)},[e("div",{class:A(["flex items-center gap-2 text-sm whitespace-nowrap px-1 py-0.5 rounded-md group",[r(m).state.currentFolder.id==t.id?"bg-secondary":"bg-primary hover"]])},[e("button",{title:"Load subfolders",onClick:f=>P(t),class:A(["transform transition-transform py-0.5",[t.showSubfolders?"rotate-90":""]])},Y,10,Q),e("button",{title:t.name,onClick:f=>T(t),class:"w-full text-left truncate"},N(t.name),9,Z),w(M,{align:"right",width:"28",class:"md:opacity-0 md:group-hover:opacity-100"},{trigger:i(()=>[ee]),content:i(()=>[e("div",te,[oe,e("button",{class:"btn btn-transparent w-full",title:"Delete folder",onClick:f=>c(t)},ne,8,se)])]),_:2},1024)],2),t.subfolders&&t.subfolders.length>0&&t.showSubfolders?(a(),u("div",ae,[w(p,{folders:t.subfolders},null,8,["folders"])])):v("",!0),t.showSubfolders?(a(),u("div",re,[e("form",{onSubmit:S(()=>{d(t.id,t.newSubfolderName),t.newSubfolderName=""},["prevent"]),class:"flex gap-1"},[de,j(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":f=>t.newSubfolderName=f},null,8,ue),[[B,t.newSubfolderName]])],40,ie)])):v("",!0)],40,K))),256)),y.root?(a(),u("form",{key:1,onSubmit:s[4]||(s[4]=S(()=>{d(!1,n.value),n.value=""},["prevent"])),class:"flex gap-1 pl-2"},[ce,j(e("input",{type:"text",class:"bg-transparent border-0 p-0.5 flex-grow focus:ring-0 focus:outline-none min-w-11",placeholder:"Add new folder","onUpdate:modelValue":s[3]||(s[3]=t=>n.value=t)},null,512),[[B,n.value]])],32)):v("",!0)])],2),w(L,{show:l.value,onClose:b,maxWidth:"xl"},{title:i(()=>[pe]),content:i(()=>[e("p",null,[x("Are you sure you want to delete the folder "),e("b",null,N(h.value.name),1),x("?")]),fe]),footer:i(()=>[e("button",{class:"btn",onClick:b},"Cancel"),e("button",{class:"btn btn-danger",onClick:_},"Delete")]),_:1},8,["show"])],64)}}},he={key:0,class:"flex gap-2"},be=e("i",{class:"bi bi-chevron-right"},null,-1),_e={key:0,class:"bi bi-chevron-right"},ve={__name:"FolderBreadcrumbs",setup(y){const l=O(),h=q(()=>{let n=l.getters.simplePath;return n?(n.shift(),n=n.map((c,b)=>{const _="/folder/"+n.slice(0,b+1).map(d=>d.slug).join("/");return{...c,pathSlug:_}}),n):[]});return(n,c)=>r(l).state.path?(a(),u("div",he,[w(r(C),{href:n.route("app.folders.index")},{default:i(()=>[x("Home")]),_:1},8,["href"]),be,(a(!0),u(D,null,V(h.value,(b,_)=>(a(),u(D,null,[w(r(C),{href:b.pathSlug},{default:i(()=>[x(N(b.name),1)]),_:2},1032,["href"]),_!==h.value.length-1?(a(),u("i",_e)):v("",!0)],64))),256))])):v("",!0)}},ge={class:"flex gap-4 relative flex-col md:flex-row"},we={class:"min-w-64 flex-grow relative"},xe={class:"top-0 sticky max-h-48 md:max-h-none overflow-y-auto md:overflow-y-visible pb-10 md:pb-0"},ye={class:"w-full mt-8"},Fe={class:"flex justify-between"},$e={class:"text-sm mb-2"},Se={key:0,class:"heading-1"},ke={key:1,class:"heading-1"},Ce=e("button",{class:"btn"},[x("New "),e("i",{class:"bi bi-plus-lg"})],-1),De={class:"rounded-lg p-2"},Ne=e("i",{class:"bi bi-code-slash"},null,-1),Ae=e("i",{class:"bi bi-folder"},null,-1),Ve={class:"autogrid gap-4 w-full mt-4"},Ie=e("i",{class:"bi bi-plus-circle-dotted text-2xl"},null,-1),je=e("p",null,"Create new Snippit",-1),Be=e("h3",{class:"heading-3"},"New Folder",-1),Oe=["disabled"],He={__name:"Index",props:{folder:Object,path:Object,simplePath:Object},setup(y){const l=O(),h=y;z(()=>{l.commit("initFolderData",{currentFolder:h.folder,path:h.path})});const n=k(!1),c=k("");function b(){c.value.length<3||($.post(route("app.folders.create"),{parent_id:l.state.currentFolder.id,name:c.value}).then(_=>{l.commit("addNewFolder",{folder:_.data,parentID:l.state.currentFolder.id})}),n.value=!1,c.value="")}return(_,d)=>(a(),F(E,{title:"Folders"},{default:i(()=>[e("div",null,[e("div",ge,[e("div",we,[e("div",xe,[r(l).state.path?(a(),F(me,{key:0,root:!0,folders:r(l).state.path.subfolders},null,8,["folders"])):v("",!0)])]),e("div",ye,[e("div",Fe,[e("div",null,[e("p",$e,[w(ve)]),r(l).state.currentFolder?(a(),u("h1",Se,N(r(l).state.currentFolder.name),1)):(a(),u("h1",ke,"Root"))]),w(M,{align:"right",width:"48"},{trigger:i(()=>[Ce]),content:i(()=>[e("div",De,[r(l).state.currentFolder?(a(),F(r(C),{key:0,href:_.route("app.snippit.showCreate")+"?folder_id="+r(l).state.currentFolder.id,class:"btn btn-transparent w-full block text-center"},{default:i(()=>[Ne,x(" Snippit")]),_:1},8,["href"])):v("",!0),e("button",{class:"btn btn-transparent w-full",onClick:d[0]||(d[0]=g=>n.value=!0)},[Ae,x(" Folder")])])]),_:1})]),e("div",Ve,[r(l).state.currentFolder?(a(!0),u(D,{key:0},V(r(l).state.currentFolder.snippits,g=>(a(),F(H,{snippit:g,draggable:!0,deleteAble:!0},null,8,["snippit"]))),256)):v("",!0),r(l).state.currentFolder?(a(),F(r(C),{key:1,title:"New Snippit",href:_.route("app.snippit.showCreate")+"?folder_id="+r(l).state.currentFolder.id,class:"border-gray-400 flex justify-center items-center flex-col p-4"},{default:i(()=>[Ie,je]),_:1},8,["href"])):v("",!0)])])])]),w(L,{show:n.value,onClose:d[3]||(d[3]=g=>n.value=!1),maxWidth:"xl"},{title:i(()=>[Be]),content:i(()=>[e("div",null,[e("form",{onSubmit:S(b,["prevent"])},[w(R,{modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=g=>c.value=g),label:"Folder Name"},null,8,["modelValue"])],32)])]),footer:i(()=>[e("button",{onClick:d[2]||(d[2]=g=>n.value=!1),class:"textlink"},"Cancel"),e("button",{class:"btn",disabled:c.value.length<3,onClick:b},"Save",8,Oe)]),_:1},8,["show"])]),_:1}))}};export{He as default};
